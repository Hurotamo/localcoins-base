generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  name            String? @default("")
  email           String? @default("")
  phone           String? @default("")
  address         String? @default("")
  state           String? @default("")
  country         String? @default("")
  dob             String? @default("")
  isEmailVerified Boolean @default(false)
  isPhoneVerified Boolean @default(false)
  pwHash          String? @default("")

  acceptedPaymentMethods  String[]
  publicKey               String  @unique
  nonce                   String?

  phoneOtp                String?   @default("")
  phoneOtpDoC             DateTime?

  isAdmin                 Boolean @default(false)
  SaleBuyer               Sale[] @relation("SellerRelation")
  SaleSeller              Sale[] @relation("BuyerRelation")
}

model Sale {
  id                String @id @default(auto())   @map("_id") @db.ObjectId
  sellerId          String                        @db.ObjectId
  seller            User                          @relation("SellerRelation", fields: [sellerId], references: [id])

  buyerId           String?                       @db.ObjectId
  buyer             User?                         @relation("BuyerRelation", fields: [buyerId], references: [id])

  amount            Float
  token             String?
  unitPrice         Float

  tx                String?

  screenshot        String?
  screenshotMethods  String[]
  screenshotAt      DateTime?

  paidAt            DateTime?
  finishedAt        DateTime?
  canceledAt        DateTime?

  createdAt         DateTime                      @default(now())
}
